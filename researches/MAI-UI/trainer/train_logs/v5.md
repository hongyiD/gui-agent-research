unsloth@fcf2aae2e869:/workspace/mai-ui-trainer/trainer$ python sft_trainer.py --config configs/my_config_119.yaml
Skipping import of cpp extensions due to incompatible torch version 2.9.0+cu128 for torchao version 0.13.0
============================================================
Training Configuration Summary
============================================================
Model path: /workspace/MAI-UI-2B
Data path: /workspace/mai-ui-trainer/dataset/20260128_113523/sft_train.jsonl
Output directory: /workspace/mai-ui-trainer/trainer/models/sft_model/20260128_052419
Max length: 4096
Use LoRA: True
  LoRA r: 16
  LoRA alpha: 32
  LoRA dropout: 0.05
  LoRA target modules: ['q_proj', 'k_proj', 'v_proj', 'o_proj']
Use 4-bit quantization: True
Gradient checkpointing: True
============================================================

Using 4-bit quantization with compute dtype: torch.float16
GPU compute capability (7, 0), using float16 (V100 or older)
Loaded as Qwen3VL model with multi-modal support
VL Model: True
Gradient checkpointing enabled
All model parameters frozen for LoRA training
trainable params: 6,422,528 || all params: 2,133,954,560 || trainable%: 0.3010
LoRA applied successfully
Loading dataset from: /workspace/mai-ui-trainer/dataset/20260128_113523/sft_train.jsonl
Dataset size: 27
Sample keys: ['messages', 'metadata']
  messages: list with 3 items
    First item type: <class 'dict'>
  metadata: <class 'dict'>

Data contains images: True
Training with fp16=True (GPU does not support bfloat16, using float16)
Using MultiModalDataCollator for vision-language training (max 1 images/sample)
Image base directory: /workspace/mai-ui-trainer/dataset/20260128_113523

============================================================
DATASET PREPROCESSING
============================================================
  Max images per sample: 1
  Total samples: 27
  Data directory: /workspace/mai-ui-trainer/dataset/20260128_113523
Decoding images: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 27/27 [00:00<00:00, 71.40it/s]

============================================================
PREPROCESSING SUMMARY
============================================================
  Samples processed: 27
  Original images: 27 (1.0 avg/sample)
  After limiting: 27 (1.0 avg/sample)
  Avg image size: 460x1024 pixels
============================================================

Detected kernel version 3.10.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.

NOTE: First step may be slow due to JIT compilation and image processing.
      Watch for detailed step-by-step logs below.

The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'bos_token_id': None}.

======================================================================
TRAINING STARTED
======================================================================
  Total steps: 35
  Epochs: 5
  Batch size: 1
  Gradient accumulation: 4
  Effective batch size: 4
  Learning rate: 0.0001
  FP16: True, BF16: False
  Gradient checkpointing: True
  GPU: Tesla V100-SXM2-32GB
  GPU Memory: 31.7 GB total
======================================================================

  0%|                                                                                                                                                                                                                                                          | 0/35 [00:00<?, ?it/s]
--- Epoch 1/5 ---
[DEBUG] apply_chat_template: 0.05s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.06s
[DEBUG] apply_chat_template: 0.00s, processor: 0.05s
[Step 1/35] time: 124.55s | VRAM: 2.2/31.7GB (7%) | ETA: 1.2h
{'loss': 0.4694, 'grad_norm': 1.844184160232544, 'learning_rate': 0.0, 'epoch': 0.15}                                                                                                                                                                                                 
  3%|██████▊                                                                                                                                                                                                                                        | 1/35 [02:04<1:10:44, 124.85s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 2/35] time: 126.16s | loss: 0.4694 | lr: 0.00e+00 | VRAM: 2.2/31.7GB (7%) | ETA: 1.2h
{'loss': 0.6304, 'grad_norm': 1.4634239673614502, 'learning_rate': 0.0001, 'epoch': 0.3}                                                                                                                                                                                              
  6%|█████████████▋                                                                                                                                                                                                                                 | 2/35 [04:11<1:09:08, 125.71s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 3/35] time: 123.01s | loss: 0.6304 | lr: 1.00e-04 | VRAM: 2.2/31.7GB (7%) | ETA: 1.1h
{'loss': 0.5811, 'grad_norm': 1.3301366567611694, 'learning_rate': 9.705882352941177e-05, 'epoch': 0.44}                                                                                                                                                                              
  9%|████████████████████▍                                                                                                                                                                                                                          | 3/35 [06:14<1:06:25, 124.54s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 4/35] time: 122.06s | loss: 0.5811 | lr: 9.71e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 1.1h
{'loss': 0.5201, 'grad_norm': 1.135095477104187, 'learning_rate': 9.411764705882353e-05, 'epoch': 0.59}                                                                                                                                                                               
 11%|███████████████████████████▎                                                                                                                                                                                                                   | 4/35 [08:16<1:03:52, 123.62s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 5/35] time: 122.48s | loss: 0.5201 | lr: 9.41e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 1.0h
{'loss': 0.4871, 'grad_norm': 1.6447216272354126, 'learning_rate': 9.11764705882353e-05, 'epoch': 0.74}                                                                                                                                                                               
 14%|██████████████████████████████████▏                                                                                                                                                                                                            | 5/35 [10:19<1:01:38, 123.27s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 6/35] time: 122.11s | loss: 0.4871 | lr: 9.12e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 59.8m
{'loss': 0.6511, 'grad_norm': 2.361999034881592, 'learning_rate': 8.823529411764706e-05, 'epoch': 0.89}                                                                                                                                                                               
 17%|█████████████████████████████████████████▎                                                                                                                                                                                                       | 6/35 [12:22<59:33, 123.23s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.05s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 7/35] time: 93.36s | loss: 0.6511 | lr: 8.82e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 55.7m
{'loss': 0.6949, 'grad_norm': 1.3875401020050049, 'learning_rate': 8.529411764705883e-05, 'epoch': 1.0}                                                                                                                                                                               
 20%|████████████████████████████████████████████████▏                                                                                                                                                                                                | 7/35 [13:55<52:57, 113.50s/it]
--- Epoch 2/5 ---
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 8/35] time: 121.84s | loss: 0.6949 | lr: 8.53e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 53.9m
{'loss': 0.4411, 'grad_norm': 1.4013543128967285, 'learning_rate': 8.23529411764706e-05, 'epoch': 1.15}                                                                                                                                                                               
 23%|███████████████████████████████████████████████████████                                                                                                                                                                                          | 8/35 [15:57<52:17, 116.21s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 9/35] time: 124.02s | loss: 0.4411 | lr: 8.24e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 52.1m
{'loss': 0.5094, 'grad_norm': 0.8956661820411682, 'learning_rate': 7.941176470588235e-05, 'epoch': 1.3}                                                                                                                                                                               
 26%|█████████████████████████████████████████████████████████████▉                                                                                                                                                                                   | 9/35 [18:01<51:26, 118.71s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 10/35] time: 123.79s | loss: 0.5094 | lr: 7.94e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 50.2m
{'loss': 0.378, 'grad_norm': 0.8780016899108887, 'learning_rate': 7.647058823529411e-05, 'epoch': 1.44}                                                                                                                                                                               
 29%|████████████████████████████████████████████████████████████████████▌                                                                                                                                                                           | 10/35 [20:05<50:07, 120.32s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[Step 11/35] time: 123.08s | loss: 0.3780 | lr: 7.65e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 48.4m
{'loss': 0.4632, 'grad_norm': 0.9021736979484558, 'learning_rate': 7.352941176470589e-05, 'epoch': 1.59}                                                                                                                                                                              
 31%|███████████████████████████████████████████████████████████████████████████▍                                                                                                                                                                    | 11/35 [22:10<48:35, 121.49s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 12/35] time: 122.42s | loss: 0.4632 | lr: 7.35e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 46.4m
{'loss': 0.497, 'grad_norm': 0.929792046546936, 'learning_rate': 7.058823529411765e-05, 'epoch': 1.74}                                                                                                                                                                                
 34%|██████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                             | 12/35 [24:12<46:41, 121.82s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 13/35] time: 121.90s | loss: 0.4970 | lr: 7.06e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 44.4m
{'loss': 0.3975, 'grad_norm': 1.0900505781173706, 'learning_rate': 6.764705882352942e-05, 'epoch': 1.89}                                                                                                                                                                              
 37%|█████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                                                      | 13/35 [26:14<44:41, 121.89s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[Step 14/35] time: 92.52s | loss: 0.3975 | lr: 6.76e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 41.7m
{'loss': 0.4582, 'grad_norm': 1.1261138916015625, 'learning_rate': 6.470588235294118e-05, 'epoch': 2.0}                                                                                                                                                                               
 40%|████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                | 14/35 [27:47<39:33, 113.04s/it]
--- Epoch 3/5 ---
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[Step 15/35] time: 123.55s | loss: 0.4582 | lr: 6.47e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 39.8m
{'loss': 0.4766, 'grad_norm': 0.8669700026512146, 'learning_rate': 6.176470588235295e-05, 'epoch': 2.15}                                                                                                                                                                              
 43%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                                         | 15/35 [29:51<38:45, 116.27s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 16/35] time: 122.64s | loss: 0.4766 | lr: 6.18e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 37.9m
{'loss': 0.4281, 'grad_norm': 0.8371521830558777, 'learning_rate': 5.882352941176471e-05, 'epoch': 2.3}                                                                                                                                                                               
 46%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                  | 16/35 [31:54<37:31, 118.51s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 17/35] time: 120.86s | loss: 0.4281 | lr: 5.88e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 35.9m
{'loss': 0.4102, 'grad_norm': 0.9912416934967041, 'learning_rate': 5.588235294117647e-05, 'epoch': 2.44}                                                                                                                                                                              
 49%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                           | 17/35 [33:55<35:46, 119.26s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 18/35] time: 121.31s | loss: 0.4102 | lr: 5.59e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 34.0m
{'loss': 0.3859, 'grad_norm': 0.8918020129203796, 'learning_rate': 5.294117647058824e-05, 'epoch': 2.59}                                                                                                                                                                              
 51%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                    | 18/35 [35:57<33:58, 119.92s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 19/35] time: 121.54s | loss: 0.3859 | lr: 5.29e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 32.0m
{'loss': 0.3743, 'grad_norm': 0.8442047834396362, 'learning_rate': 5e-05, 'epoch': 2.74}                                                                                                                                                                                              
 54%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                             | 19/35 [37:58<32:07, 120.45s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[Step 20/35] time: 121.78s | loss: 0.3743 | lr: 5.00e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 30.0m
{'loss': 0.3688, 'grad_norm': 0.7023657560348511, 'learning_rate': 4.705882352941177e-05, 'epoch': 2.89}                                                                                                                                                                              
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                      | 20/35 [40:00<30:13, 120.89s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 21/35] time: 93.49s | loss: 0.3688 | lr: 4.71e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 27.7m
{'loss': 0.2435, 'grad_norm': 0.906018078327179, 'learning_rate': 4.411764705882353e-05, 'epoch': 3.0}                                                                                                                                                                                
 60%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                | 21/35 [41:35<26:21, 112.97s/it]
--- Epoch 4/5 ---
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 22/35] time: 124.54s | loss: 0.2435 | lr: 4.41e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 25.8m
{'loss': 0.3006, 'grad_norm': 0.7775486707687378, 'learning_rate': 4.11764705882353e-05, 'epoch': 3.15}                                                                                                                                                                               
 63%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                         | 22/35 [43:40<25:14, 116.49s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[Step 23/35] time: 123.50s | loss: 0.3006 | lr: 4.12e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 23.9m
{'loss': 0.3552, 'grad_norm': 0.763665497303009, 'learning_rate': 3.8235294117647055e-05, 'epoch': 3.3}                                                                                                                                                                               
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                  | 23/35 [45:43<23:43, 118.63s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 24/35] time: 122.50s | loss: 0.3552 | lr: 3.82e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 21.9m
{'loss': 0.3221, 'grad_norm': 0.8706349730491638, 'learning_rate': 3.529411764705883e-05, 'epoch': 3.44}                                                                                                                                                                              
 69%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                           | 24/35 [47:46<21:58, 119.84s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 25/35] time: 125.73s | loss: 0.3221 | lr: 3.53e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 19.9m
{'loss': 0.4101, 'grad_norm': 0.8909265995025635, 'learning_rate': 3.235294117647059e-05, 'epoch': 3.59}                                                                                                                                                                              
 71%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                    | 25/35 [49:52<20:16, 121.65s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 26/35] time: 121.73s | loss: 0.4101 | lr: 3.24e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 18.0m
{'loss': 0.3007, 'grad_norm': 0.8421053290367126, 'learning_rate': 2.9411764705882354e-05, 'epoch': 3.74}                                                                                                                                                                             
 74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                             | 26/35 [51:54<18:17, 122.00s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 27/35] time: 121.37s | loss: 0.3007 | lr: 2.94e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 16.0m
{'loss': 0.343, 'grad_norm': 1.0797762870788574, 'learning_rate': 2.647058823529412e-05, 'epoch': 3.89}                                                                                                                                                                               
 77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                      | 27/35 [53:56<16:14, 121.85s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[Step 28/35] time: 92.25s | loss: 0.3430 | lr: 2.65e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 13.9m
{'loss': 0.3796, 'grad_norm': 1.0855309963226318, 'learning_rate': 2.3529411764705884e-05, 'epoch': 4.0}                                                                                                                                                                              
 80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                | 28/35 [55:28<13:10, 113.00s/it]
--- Epoch 5/5 ---
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[Step 29/35] time: 122.79s | loss: 0.3796 | lr: 2.35e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 11.9m
{'loss': 0.3683, 'grad_norm': 0.9131925702095032, 'learning_rate': 2.058823529411765e-05, 'epoch': 4.15}                                                                                                                                                                              
 83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                         | 29/35 [57:31<11:35, 115.99s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 30/35] time: 120.55s | loss: 0.3683 | lr: 2.06e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 9.9m
{'loss': 0.2787, 'grad_norm': 0.8521679639816284, 'learning_rate': 1.7647058823529414e-05, 'epoch': 4.3}                                                                                                                                                                              
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                  | 30/35 [59:32<09:46, 117.40s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[Step 31/35] time: 121.46s | loss: 0.2787 | lr: 1.76e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 7.9m
{'loss': 0.3162, 'grad_norm': 1.0034898519515991, 'learning_rate': 1.4705882352941177e-05, 'epoch': 4.44}                                                                                                                                                                             
 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                           | 31/35 [1:01:34<07:55, 118.93s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[Step 32/35] time: 123.50s | loss: 0.3162 | lr: 1.47e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 6.0m
{'loss': 0.3117, 'grad_norm': 0.8779011964797974, 'learning_rate': 1.1764705882352942e-05, 'epoch': 4.59}                                                                                                                                                                             
 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                    | 32/35 [1:03:38<06:01, 120.35s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.04s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[Step 33/35] time: 123.41s | loss: 0.3117 | lr: 1.18e-05 | VRAM: 2.2/31.7GB (7%) | ETA: 4.0m
{'loss': 0.3776, 'grad_norm': 0.9258959293365479, 'learning_rate': 8.823529411764707e-06, 'epoch': 4.74}                                                                                                                                                                              
 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍             | 33/35 [1:05:42<04:02, 121.31s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[Step 34/35] time: 122.85s | loss: 0.3776 | lr: 8.82e-06 | VRAM: 2.2/31.7GB (7%) | ETA: 2.0m
{'loss': 0.3278, 'grad_norm': 0.8179761171340942, 'learning_rate': 5.882352941176471e-06, 'epoch': 4.89}                                                                                                                                                                              
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏      | 34/35 [1:07:45<02:01, 121.82s/it][DEBUG] apply_chat_template: 0.00s, processor: 0.03s
[DEBUG] apply_chat_template: 0.00s, processor: 0.02s
[Step 35/35] time: 94.16s | loss: 0.3278 | lr: 5.88e-06 | VRAM: 2.2/31.7GB (7%) | ETA: 0s
{'loss': 0.2125, 'grad_norm': 1.142195224761963, 'learning_rate': 2.9411764705882355e-06, 'epoch': 5.0}                                                                                                                                                                               
{'train_runtime': 4160.3579, 'train_samples_per_second': 0.032, 'train_steps_per_second': 0.008, 'train_loss': 0.4134290882519313, 'epoch': 5.0}                                                                                                                                      
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [1:09:20<00:00, 113.54s/it]
======================================================================
TRAINING COMPLETED
======================================================================
  Total time: 1.2h
  Total steps: 35
  Final loss: 0.2125
  Peak GPU memory: 9.70 GB
======================================================================

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 35/35 [1:09:20<00:00, 118.87s/it]
LoRA weights saved to /workspace/mai-ui-trainer/trainer/models/sft_model/20260128_052419
Processor saved to /workspace/mai-ui-trainer/trainer/models/sft_model/20260128_052419
SFT training completed. Output saved to /workspace/mai-ui-trainer/trainer/models/sft_model/20260128_052419